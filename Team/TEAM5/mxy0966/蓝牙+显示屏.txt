#include <SoftwareSerial.h>
#include <Servo.h>
#include <U8glib.h>
String currentInfo="";
#define my_Serial Serial
U8GLIB_SSD1306_128X64 u8g(U8G_I2C_OPT_NONE);
#define setFont_L u8g.setFont(u8g_font_unifont)
#define setFont_S u8g.setFont(u8g_font_fixed_v0r)
#define setFont_M u8g.setFont(u8g_font_9x15)
Servo servo_2;
char item;
void BLE_to_control();
void setup()
{
  Serial.begin(9600);
  my_Serial.begin(57600);
  pinMode(12, OUTPUT);
  servo_2.attach(2);
  Serial.println('2');
void loop()
{
  digitalWrite(12,LOW);
  BLE_to_control();
   if (!digitalRead(10)) {
    digitalWrite(12,HIGH);
    servo_2.write(90);
  u8g.undoRotation();
  u8g.firstPage();
  do {
    setFont_M;
    u8g.setPrintPos(0, 20);
    u8g.print("Closed by button!");
  } while( u8g.nextPage() );
  }
    if (Serial.available() > 0) {
    item = Serial.read();
    if (item=='0') {
      servo_2.write(0);
      Serial.write(item);
      delay(0);
    }
    Serial.flush();
  }
  //if (!digitalRead(8)) Serial.println('1');
}
void BLE_to_control()
{
if (my_Serial.available() > 0) {
   currentInfo = my_Serial.readStringUntil('\n');
    if (currentInfo == "on") {
      servo_2.write(180);
      digitalWrite(12,HIGH);
      my_Serial.println("Open successfully!");
        u8g.undoRotation();
  u8g.firstPage();
  do {
    setFont_M;
    u8g.setPrintPos(0, 20);
    u8g.print("Opened");
  } while( u8g.nextPage() );
      delay(50);
    } else if (currentInfo == "off") {
      servo_2.write(90);
      my_Serial.println("Closed!");
      digitalWrite(12,HIGH);
        u8g.undoRotation();
  u8g.firstPage();
  do {
    setFont_M;
    u8g.setPrintPos(0, 20);
    u8g.print("Closed!");
  } while( u8g.nextPage() );
      delay(50);
    }
  }
}    //蓝牙+按键+显示屏（在线）